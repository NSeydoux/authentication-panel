<svg xmlns="http://www.w3.org/2000/svg" width="1040.9296875px" height="1210.390625px" class="sequence simple"><desc>Authorization Code flow with PKCE</desc><defs><marker viewBox="0 0 5 5" markerWidth="5" markerHeight="5" orient="auto" refX="5" refY="2.5" id="markerArrowBlock"><path d="M 0 0 L 5 2.5 L 0 5 z"/></marker><marker viewBox="0 0 9.6 16" markerWidth="4" markerHeight="16" orient="auto" refX="9.6" refY="8" id="markerArrowOpen"><path d="M 9.6,8 1.92,16 0,13.7 5.76,8 0,2.286 1.92,0 9.6,8 z"/></marker></defs><g class="title"><rect x="10" y="10" width="326.78125" height="28.015625" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"/><text x="15" y="29.40625" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="15">Authorization Code flow with PKCE</tspan></text></g><g class="actor"><rect x="192.1875" y="48.015625" width="39.203125" height="38.015625" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"/><text x="202.1875" y="72.421875" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="202.1875">RP</tspan></text></g><g class="actor"><rect x="192.1875" y="1152.375" width="39.203125" height="38.015625" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"/><text x="202.1875" y="1176.78125" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="202.1875">RP</tspan></text></g><line x1="211.7890625" x2="211.7890625" y1="86.03125" y2="1152.375" stroke="#000000" fill="none" style="stroke-width: 2;"/><g class="actor"><rect x="336.9765625" y="48.015625" width="173.59375" height="38.015625" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"/><text x="346.9765625" y="72.421875" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="346.9765625">Alice's Pod (RS)</tspan></text></g><g class="actor"><rect x="336.9765625" y="1152.375" width="173.59375" height="38.015625" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"/><text x="346.9765625" y="1176.78125" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="346.9765625">Alice's Pod (RS)</tspan></text></g><line x1="423.7734375" x2="423.7734375" y1="86.03125" y2="1152.375" stroke="#000000" fill="none" style="stroke-width: 2;"/><g class="actor"><rect x="630.3515625" y="48.015625" width="116" height="38.015625" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"/><text x="640.3515625" y="72.421875" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="640.3515625">Alice's OP</tspan></text></g><g class="actor"><rect x="630.3515625" y="1152.375" width="116" height="38.015625" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"/><text x="640.3515625" y="1176.78125" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="640.3515625">Alice's OP</tspan></text></g><line x1="688.3515625" x2="688.3515625" y1="86.03125" y2="1152.375" stroke="#000000" fill="none" style="stroke-width: 2;"/><g class="actor"><rect x="894.9296875" y="48.015625" width="116" height="38.015625" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"/><text x="904.9296875" y="72.421875" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="904.9296875">RP's WebID</tspan></text></g><g class="actor"><rect x="894.9296875" y="1152.375" width="116" height="38.015625" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"/><text x="904.9296875" y="1176.78125" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="904.9296875">RP's WebID</tspan></text></g><line x1="952.9296875" x2="952.9296875" y1="86.03125" y2="1152.375" stroke="#000000" fill="none" style="stroke-width: 2;"/><g class="note"><rect x="48.3984375" y="106.03125" width="326.78125" height="28.015625" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"/><text x="53.3984375" y="125.4375" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="53.3984375">1.Alice uses the decentphotos app</tspan></text></g><g class="note"><rect x="53.1953125" y="154.046875" width="317.1875" height="28.015625" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"/><text x="58.1953125" y="173.453125" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="58.1953125">2. Alice selects her OP or WebID</tspan></text></g><g class="signal"><text x="221.7890625" y="212.4609375" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="221.7890625">2.1 Retrieve Profile</tspan></text><line x1="211.7890625" x2="423.7734375" y1="220.078125" y2="220.078125" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"/></g><g class="signal"><text x="317.78125" y="245.078125" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="317.78125"/></text><line x1="423.7734375" x2="211.7890625" y1="240.078125" y2="240.078125" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"/></g><g class="signal"><text x="315.6796875" y="270.4765625" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="315.6796875">3. Retrieve OP configuration</tspan></text><line x1="211.7890625" x2="688.3515625" y1="278.09375" y2="278.09375" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"/></g><g class="signal"><text x="450.0703125" y="303.09375" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="450.0703125"/></text><line x1="688.3515625" x2="211.7890625" y1="298.09375" y2="298.09375" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"/></g><g class="note"><rect x="14.8046875" y="318.09375" width="393.96875" height="28.015625" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"/><text x="19.8046875" y="337.5" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="19.8046875">4. Generates PKCE code and code verifier</tspan></text></g><g class="note"><rect x="10" y="366.109375" width="403.578125" height="28.015625" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"/><text x="15" y="385.515625" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="15">5. Saves code verifier to session storage</tspan></text></g><g class="signal"><text x="334.875" y="424.5234375" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="334.875">6. Authorization Request</tspan></text><line x1="211.7890625" x2="688.3515625" y1="432.140625" y2="432.140625" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"/></g><g class="signal"><text x="739.046875" y="462.5390625" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="739.046875">7. Fetch RP WebID</tspan></text><line x1="688.3515625" x2="952.9296875" y1="470.15625" y2="470.15625" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"/></g><g class="signal"><text x="820.640625" y="495.15625" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="820.640625"/></text><line x1="952.9296875" x2="688.3515625" y1="490.15625" y2="490.15625" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"/></g><g class="note"><rect x="510.5625" y="510.15625" width="355.578125" height="28.015625" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"/><text x="515.5625" y="529.5625" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="515.5625">8. Validates redirect url with WebID</tspan></text></g><g class="note"><rect x="606.5546875" y="558.171875" width="163.59375" height="28.015625" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"/><text x="611.5546875" y="577.578125" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="611.5546875">9. Alice Logs In</tspan></text></g><g class="note"><rect x="587.359375" y="606.1875" width="201.984375" height="28.015625" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"/><text x="592.359375" y="625.59375" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="592.359375">10. Generates a code</tspan></text></g><g class="signal"><text x="310.875" y="664.6015625" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="310.875">11. Send code to redirect url</tspan></text><line x1="688.3515625" x2="211.7890625" y1="672.21875" y2="672.21875" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"/></g><g class="note"><rect x="43.6015625" y="692.21875" width="336.375" height="28.015625" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"/><text x="48.6015625" y="711.625" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="48.6015625">12. Generates DPoP Client Key Pair</tspan></text></g><g class="note"><rect x="77.1953125" y="740.234375" width="269.1875" height="28.015625" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"/><text x="82.1953125" y="759.640625" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="82.1953125">13. Generates a DPoP Header</tspan></text></g><g class="signal"><text x="234.0859375" y="798.6484375" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="234.0859375">14. Token request with code and code verifier</tspan></text><line x1="211.7890625" x2="688.3515625" y1="806.265625" y2="806.265625" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"/></g><g class="note"><rect x="553.7578125" y="826.265625" width="269.1875" height="28.015625" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"/><text x="558.7578125" y="845.671875" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="558.7578125">15. Validates code verifier</tspan></text></g><g class="note"><rect x="520.1640625" y="874.28125" width="336.375" height="28.015625" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"/><text x="525.1640625" y="893.6875" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="525.1640625">16. Validates DPoP Token signature</tspan></text></g><g class="note"><rect x="433.7734375" y="922.296875" width="509.15625" height="28.015625" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"/><text x="438.7734375" y="941.703125" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="438.7734375">17. Converts the DPoP public key to a JWK thumbprint</tspan></text></g><g class="note"><rect x="558.5625" y="970.3125" width="259.578125" height="28.015625" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"/><text x="563.5625" y="989.71875" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="563.5625">18. Generates access token</tspan></text></g><g class="note"><rect x="577.7578125" y="1018.328125" width="221.1875" height="28.015625" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"/><text x="582.7578125" y="1037.734375" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="582.7578125">19. Generates id token</tspan></text></g><g class="note"><rect x="553.7578125" y="1066.34375" width="269.1875" height="28.015625" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"/><text x="558.7578125" y="1085.75" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="558.7578125">20. Generates refresh token</tspan></text></g><g class="signal"><text x="378.0703125" y="1124.7578125" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="378.0703125">21. Send tokens</tspan></text><line x1="688.3515625" x2="211.7890625" y1="1132.375" y2="1132.375" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"/></g></svg>