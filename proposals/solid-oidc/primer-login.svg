<svg xmlns="http://www.w3.org/2000/svg" width="1026.75px" height="1354px" class="sequence simple"><desc>Logging in with Authorization Code Flow with PKCE</desc><defs><marker viewBox="0 0 5 5" markerWidth="5" markerHeight="5" orient="auto" refX="5" refY="2.5" id="markerArrowBlock"><path d="M 0 0 L 5 2.5 L 0 5 z"/></marker><marker viewBox="0 0 9.6 16" markerWidth="4" markerHeight="16" orient="auto" refX="9.6" refY="8" id="markerArrowOpen"><path d="M 9.6,8 1.92,16 0,13.7 5.76,8 0,2.286 1.92,0 9.6,8 z"/></marker></defs><g class="title"><rect x="10" y="10" width="480.484375" height="28" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"/><text x="15" y="29.5" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="15">Logging in with Authorization Code Flow with PKCE</tspan></text></g><g class="actor"><rect x="187.4296875" y="48" width="39.203125" height="38" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"/><text x="197.4296875" y="72.5" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="197.4296875">RP</tspan></text></g><g class="actor"><rect x="187.4296875" y="1296" width="39.203125" height="38" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"/><text x="197.4296875" y="1320.5" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="197.4296875">RP</tspan></text></g><line x1="207.03125" x2="207.03125" y1="86" y2="1296" stroke="#000000" fill="none" style="stroke-width: 2;"/><g class="actor"><rect x="346.6484375" y="48" width="144.828125" height="38" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"/><text x="356.6484375" y="72.5" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="356.6484375">Alice's WebID</tspan></text></g><g class="actor"><rect x="346.6484375" y="1296" width="144.828125" height="38" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"/><text x="356.6484375" y="1320.5" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="356.6484375">Alice's WebID</tspan></text></g><line x1="419.0625" x2="419.0625" y1="86" y2="1296" stroke="#000000" fill="none" style="stroke-width: 2;"/><g class="actor"><rect x="625.6953125" y="48" width="116.015625" height="38" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"/><text x="635.6953125" y="72.5" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="635.6953125">Alice's OP</tspan></text></g><g class="actor"><rect x="625.6953125" y="1296" width="116.015625" height="38" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"/><text x="635.6953125" y="1320.5" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="635.6953125">Alice's OP</tspan></text></g><line x1="683.703125" x2="683.703125" y1="86" y2="1296" stroke="#000000" fill="none" style="stroke-width: 2;"/><g class="actor"><rect x="899.9375" y="48" width="96.8125" height="38" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"/><text x="909.9375" y="72.5" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="909.9375">RS WebID</tspan></text></g><g class="actor"><rect x="899.9375" y="1296" width="96.8125" height="38" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"/><text x="909.9375" y="1320.5" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="909.9375">RS WebID</tspan></text></g><line x1="948.34375" x2="948.34375" y1="86" y2="1296" stroke="#000000" fill="none" style="stroke-width: 2;"/><g class="note"><rect x="43.6015625" y="106" width="326.859375" height="28" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"/><text x="48.6015625" y="125.5" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="48.6015625">1.Alice uses the decentphotos app</tspan></text></g><g class="note"><rect x="53.203125" y="154" width="307.65625" height="28" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"/><text x="58.203125" y="173.5" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="58.203125">2. Alice selets her OP or WebID</tspan></text></g><g class="signal"><text x="217.03125" y="212.5" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="217.03125">2.1 Retrieve Profile</tspan></text><line x1="207.03125" x2="419.0625" y1="220" y2="220" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"/></g><g class="signal"><text x="313.046875" y="245" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="313.046875"/></text><line x1="419.0625" x2="207.03125" y1="240" y2="240" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"/></g><g class="signal"><text x="306.140625" y="270.5" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="306.140625">3. Retrieves OP configuration</tspan></text><line x1="207.03125" x2="683.703125" y1="278" y2="278" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"/></g><g class="signal"><text x="445.3671875" y="303" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="445.3671875"/></text><line x1="683.703125" x2="207.03125" y1="298" y2="298" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"/></g><g class="note"><rect x="10" y="318" width="394.0625" height="28" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"/><text x="15" y="337.5" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="15">4. Generates PKCE code and code verifier</tspan></text></g><g class="note"><rect x="19.6015625" y="366" width="374.859375" height="28" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"/><text x="24.6015625" y="385.5" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="24.6015625">5. Saves code verifier to localstorage</tspan></text></g><g class="signal"><text x="330.1484375" y="424.5" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="330.1484375">6. Authorization Request</tspan></text><line x1="207.03125" x2="683.703125" y1="432" y2="432" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"/></g><g class="signal"><text x="734.40625" y="462.5" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="734.40625">7. Fetch RS WebID</tspan></text><line x1="683.703125" x2="948.34375" y1="470" y2="470" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"/></g><g class="signal"><text x="816.0234375" y="495" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="816.0234375"/></text><line x1="948.34375" x2="683.703125" y1="490" y2="490" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"/></g><g class="note"><rect x="505.875" y="510" width="355.65625" height="28" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"/><text x="510.875" y="529.5" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="510.875">8. Validates redirect url with WebID</tspan></text></g><g class="note"><rect x="601.890625" y="558" width="163.625" height="28" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"/><text x="606.890625" y="577.5" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="606.890625">9. Alice Logs In</tspan></text></g><g class="note"><rect x="573.0859375" y="606" width="221.234375" height="28" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"/><text x="578.0859375" y="625.5" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="578.0859375">10. Generates id token</tspan></text></g><g class="note"><rect x="582.6875" y="654" width="202.03125" height="28" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"/><text x="587.6875" y="673.5" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="587.6875">11. Generates a code</tspan></text></g><g class="signal"><text x="301.34375" y="712.5" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="301.34375">12. Sends code to redirect url</tspan></text><line x1="683.703125" x2="207.03125" y1="720" y2="720" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"/></g><g class="note"><rect x="38.8046875" y="740" width="336.453125" height="28" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"/><text x="43.8046875" y="759.5" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="43.8046875">13. Generates DPoP Client Key Pair</tspan></text></g><g class="note"><rect x="72.40625" y="788" width="269.25" height="28" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"/><text x="77.40625" y="807.5" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="77.40625">14. Generates a DPoP Header</tspan></text></g><g class="note"><rect x="38.8046875" y="836" width="336.453125" height="28" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"/><text x="43.8046875" y="855.5" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="43.8046875">15. Generates Basic Authentication</tspan></text></g><g class="signal"><text x="234.1328125" y="894.5" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="234.1328125">16. Token requst with code and code verifier</tspan></text><line x1="207.03125" x2="683.703125" y1="902" y2="902" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"/></g><g class="note"><rect x="520.2734375" y="922" width="326.859375" height="28" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"/><text x="525.2734375" y="941.5" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="525.2734375">17. Validate client id and secret</tspan></text></g><g class="note"><rect x="549.078125" y="970" width="269.25" height="28" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"/><text x="554.078125" y="989.5" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="554.078125">18. Validates code verifier</tspan></text></g><g class="note"><rect x="515.4765625" y="1018" width="336.453125" height="28" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"/><text x="520.4765625" y="1037.5" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="520.4765625">19. Validates DPoP Token signature</tspan></text></g><g class="note"><rect x="429.0625" y="1066" width="509.28125" height="28" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"/><text x="434.0625" y="1085.5" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="434.0625">20. Converts the DPoP public key to a JWK thumbprint</tspan></text></g><g class="note"><rect x="553.8828125" y="1114" width="259.640625" height="28" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"/><text x="558.8828125" y="1133.5" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="558.8828125">21. Generates access token</tspan></text></g><g class="note"><rect x="573.0859375" y="1162" width="221.234375" height="28" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"/><text x="578.0859375" y="1181.5" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="578.0859375">22. Generates id token</tspan></text></g><g class="note"><rect x="549.078125" y="1210" width="269.25" height="28" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"/><text x="554.078125" y="1229.5" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="554.078125">23. Generates refresh token</tspan></text></g><g class="signal"><text x="368.5546875" y="1268.5" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="368.5546875">23. Sends tokens</tspan></text><line x1="683.703125" x2="207.03125" y1="1276" y2="1276" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"/></g></svg>